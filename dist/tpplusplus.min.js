/*! tpplusplus - v0.0.1 - 2014-03-27
* https://github.com/techdotpro/tpplusplus
* Copyright (c) 2014 ;*/
!function(){"use strict";"function"!=typeof Object.create&&!function(){var a=function(){};Object.create=function(b){return a.prototype=b,new a}}();var a={};a.Core={},a.UI={},a.UI.Widgets={},a.Utils={},a.DOM={};var b=function(a,b){for(var c,d=/{{(\s*[\w\.]+\s*)}}/g,e=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,f="var r=[];\n",g=0,h=function(a,b){return f+=b?a.match(e)?a+"\n":"r.push(this."+a+");\n":""!==a?"r.push('"+a.replace(/"/g,'\\"')+"');\n":"",h};c=d.exec(a);)h(a.slice(g,c.index))(c[1],!0),g=c.index+c[0].length;return h(a.substr(g,a.length-g)),f+='return r.join("");',new Function(f.replace(/[\r\t\n]/g,"")).apply(b)};a.$=function(){return document.querySelectorAll.apply(document,arguments)},a.$.on=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent(b,c)},a.DOM.insertWidget=function(a,b){var c,d=document.createElement(a.tagName);d.className=a.className;for(c in a.events)d.addEventListener(c,function(b){a.events[c].call(a,b)});b.parentNode.replaceChild(d,b),a.element=d,a.update()},a.DOM.updateWidget=function(a,b){a.element.innerHTML=b},a.$.on(window,"message",function(a){if("http://oil.com"===a.origin||"http://oilpro.com"===a.origin){var b=document.createElement("pre");b.style.display="block",b.innerHTML=JSON.stringify(JSON.parse(a.data),null,4),document.documentElement.appendChild(b)}});var c=document.createElement("iframe");c.width=0,c.height=0,c.style.display="none",c.src="http://oilpro.com/widget/button",document.documentElement.appendChild(c);var d={},e={},f=0;a.UI.Widgets.BaseWidget=function(){this.template="",this.data={}},a.UI.Widgets.BaseWidget.prototype.update=function(){a.DOM.updateWidget(this,b(this.template,this.data))},a.UI.Widgets.register=function(b,c){d[b]=c,c.prototype=Object.create(a.UI.Widgets.BaseWidget.prototype),c.prototype.constructor=c},a.UI.Widgets.scan=function(){var b,c;for(b in d)c=a.$("tp-"+b.toLowerCase()),c.length&&a.UI.Widgets.loadWidgets(b,c)},a.UI.Widgets.loadWidgets=function(a,b){var c,g;for(c=0,g=b.length;g>c;c++){var h=new d[a](b[c]);e[a.toLowerCase()+"_"+ ++f]=h,this.loadWidget(h,b[c])}},a.UI.Widgets._instances=e,a.UI.Widgets.loadWidget=function(b,c){a.DOM.insertWidget(b,c)},a.UI.Widgets.register("PlusPlus",function(){this.tagName="a",this.data={count:0},this.template='<img class="bookmarklet-ico" src="http://tpstatic.com/img/root/techpro/favicon.ico"><span class="bookmarklet-inner">TP++</span><span class="count">{{count}}</span>',this.className="btn-bookmarklet pull-left",this.events={click:function(){this.data.count++,this.update()}.bind(this)},this.subscriptions={countUpdate:function(a){this.data.count=a,this.update()}.bind(this)}});var g='body {font-family: "museo-sans","Helvetica Neue",Helvetica,Arial,sans-serif;} .btn-bookmarklet .bookmarklet-inner{font-size:14px;line-height:16px;font-weight:700;color:#444;vertical-align:middle;display:inline-block}Inherited from a#bookmarklet.btn-bookmarklet.pull-left .btn-bookmarklet{}.btn-bookmarklet{display:inline-block;margin-top:1px;-moz-box-shadow:#ddd 1px 1px 4px;-webkit-box-shadow:#ddd 1px 1px 4px;box-shadow:#ddd 1px 1px 4px;-webkit-border-radius:3px;-moz-border-radius:3px;border-radius:3px;padding:5px 6px;background-color:#fafafa;border:1px solid #aaa;}a{cursor:pointer;color:#457bbe}.btn-bookmarklet .bookmarklet-ico{width:16px;height:16px}a img{border:0}img{max-width:100%;vertical-align:middle;border:0;-ms-interpolation-mode:bicubic}',h=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",i.styleSheet?i.styleSheet.cssText=g:i.appendChild(document.createTextNode(g)),h.appendChild(i),a.UI.Widgets.scan(),window.TP=a}();